<html>
    <head>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const codeTextarea = document.querySelector('.code');
                const shadowTextarea = document.querySelector('.shadow');

                function syncScroll() {
                    shadowTextarea.scrollTop = codeTextarea.scrollTop;
                    shadowTextarea.scrollLeft = codeTextarea.scrollLeft;
                }

                function syncContent() {
                    let codeContent = codeTextarea.value;
                    codeContent = codeContent.replace(/^\s*:if/, "if ...:\n\t...\nelse:\n\t...");
                    codeTextarea.value = codeContent;
                    let shadowContent = codeTextarea.value;
                    shadowContent = shadowContent.replace("good", "____");
                    shadowTextarea.value = shadowContent + "!";
                }

                // Initial sync
                syncContent();
                syncScroll();

                // Event listeners
                codeTextarea.addEventListener('input', syncContent);
                codeTextarea.addEventListener('scroll', syncScroll);
            });
        </script>

        <style>
            /* shadow textarea should be invisible and below code textarea */
            .code-editor-container {
                position: relative;
                width: fit-content;
            }
            .code {
                position: relative;
                background: transparent;
                color: black;
                z-index: 2;
                font-family: monospace;
                font-size: 16px;
                line-height: 1.5;
                padding: 8px;
                border: 1px solid #ccc;
                box-sizing: border-box;
                resize: none;
                overflow: hidden;
                white-space: pre-wrap; /* Allow wrapping */
                word-wrap: break-word; /* Break long words */
            }

            .shadow {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: transparent;
                color: #999;
                z-index: 1;
            }
        </style>
    </head>
    <body>
        <div class="code-editor-container">
            <textarea cols=100 rows="10" class="code">test</textarea>
            <textarea cols=100 rows="10" class="code shadow">testing</textarea>
        </div>
    </body>

</html>